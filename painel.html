<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PAINEL AMAZ√îNIA ‚Äî Observat√≥rio Bioecol√≥gico</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    :root{
      --bg:#05080f;
      --panel: rgba(6,10,18,.86);
      --line: rgba(26,255,140,.22);
      --neon:#1aff8c;
      --text:#e4e9f2;
      --muted:#9bb0d3;

      --green: rgba(26,255,140,.95);
      --yellow: rgba(255,214,102,.95);
      --red: rgba(255,84,84,.95);
    }

    *{box-sizing:border-box;}
    body{ margin:0; font-family: Arial, Helvetica, sans-serif; background: var(--bg); color: var(--text); overflow:hidden; }

    .topbar{
      height:58px; display:flex; align-items:center; justify-content:space-between;
      padding:10px 14px;
      background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.15));
      border-bottom:1px solid rgba(15,31,58,.55);
    }
    .topbar .title{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px; border-radius:14px;
      background: var(--panel); border:1px solid var(--line);
      backdrop-filter: blur(10px);
      font-weight:900; letter-spacing:.2px; white-space:nowrap;
    }
    .topbar .title small{ font-weight:600; color: rgba(228,233,242,.75); margin-left:8px; }

    .top-actions{ display:flex; align-items:center; gap:10px; }
    .chip{
      display:flex; align-items:center; gap:8px;
      padding:10px 14px;
      border:1px solid var(--line);
      border-radius:999px;
      background: var(--panel);
      cursor:pointer; user-select:none;
      font-weight:800; transition:.2s;
      backdrop-filter: blur(10px);
      white-space:nowrap;
    }
    .chip:hover{ border-color: rgba(26,255,140,.55); box-shadow: 0 0 18px rgba(26,255,140,.12); }
    .chip.primary{ border-color: rgba(26,255,140,.45); color: var(--neon); }

    .main{
      height: calc(100vh - 58px);
      display:grid;
      grid-template-columns: 280px 1fr 320px;
      gap:12px;
      padding:12px;
    }

    .panel{
      background: var(--panel);
      border:1px solid var(--line);
      border-radius:18px;
      padding:12px;
      backdrop-filter: blur(10px);
      overflow:hidden;
    }

    .panel h3{
      margin:0 0 10px 0;
      font-size:14px;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      color: rgba(228,233,242,.95);
    }
    .panel h3 span{ color: rgba(155,176,211,.9); font-weight:700; font-size:12px; }
    .muted{color: var(--muted);}
    .divider{ height:1px; background: rgba(26,255,140,.12); margin:10px 0; }

    .mapWrap{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(26,255,140,.18);
      box-shadow: 0 0 35px rgba(26,255,140,.08) inset;
    }
    #map{ width:100%; height:100%; min-height:420px; }

    .mapHUD{
      position:absolute; left:14px; top:14px; z-index:600;
      width:min(380px, calc(100% - 28px));
      background: rgba(6,10,18,.82);
      border:1px solid rgba(26,255,140,.22);
      border-radius:14px;
      padding:10px 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 18px rgba(26,255,140,.08);
    }
    .mapHUD .big{ font-weight:900; margin-bottom:4px; }
    .mapHUD .small{ font-size:12px; color: rgba(228,233,242,.7); }

    .legend{
      position:absolute; left:14px; bottom:14px; z-index:600;
      width: 320px;
      background: rgba(6,10,18,.82);
      border:1px solid rgba(26,255,140,.22);
      border-radius:14px;
      padding:10px 12px;
      backdrop-filter: blur(10px);
    }
    .legend .bar{
      margin-top:8px; height:10px; border-radius:99px;
      background: linear-gradient(90deg, rgba(255,84,84,.95), rgba(255,214,102,.95), rgba(26,255,140,.95));
    }
    .legend .labels{
      display:flex; justify-content:space-between;
      font-size:11px; margin-top:6px;
      color: rgba(228,233,242,.75);
    }

    .kpi{ display:flex; gap:10px; flex-wrap:wrap; font-size:12px; color: rgba(228,233,242,.85); line-height:1.55; }

    .dot{ display:inline-block; width:10px;height:10px;border-radius:999px; margin-right:8px; }
    .dot.g{ background: var(--green); box-shadow:0 0 12px rgba(26,255,140,.35); }
    .dot.y{ background: var(--yellow); box-shadow:0 0 12px rgba(255,214,102,.35); }
    .dot.r{ background: var(--red); box-shadow:0 0 12px rgba(255,84,84,.35); }

    .bottom{
      grid-column: 1 / 4;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:12px;
    }

    .modalOverlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.75);
      display:none; align-items:center; justify-content:center;
      z-index:9999;
    }
    .modal{
      width:min(860px, calc(100vw - 28px));
      background: rgba(6,10,18,.92);
      border:1px solid rgba(26,255,140,.22);
      border-radius:18px;
      padding:18px;
      backdrop-filter: blur(12px);
      box-shadow: 0 10px 45px rgba(0,0,0,.55);
    }
    .modalTitle{ font-weight:900; letter-spacing:.2px; margin-bottom:8px; }
    .close{
      float:right; cursor:pointer; font-weight:900;
      border:1px solid rgba(26,255,140,.22);
      border-radius:999px; padding:6px 10px;
      color: rgba(228,233,242,.92);
    }
    .close:hover{ border-color: rgba(26,255,140,.55); }

    ul.bullet{ padding-left:18px; margin:8px 0 0; }
    ul.bullet li{ margin:8px 0; }

    @media (max-width: 980px){
      body{ overflow:auto; }
      .main{ height:auto; grid-template-columns: 1fr; }
      .bottom{ grid-template-columns: 1fr; grid-column: 1; }
      #map{ height: 62vh; }
    }

    /* slider de densidade */
    .sliderRow{
      display:flex; align-items:center; gap:10px;
      font-size:12px;
      margin-top:8px;
    }
    input[type="range"]{ width:160px; }
  </style>
</head>

<body>

  <div class="topbar">
    <div class="title">
      PAINEL AMAZ√îNIA ‚Äî Observat√≥rio Bioecol√≥gico
      <small>Dados p√∫blicos ‚Ä¢ Atualiza√ß√£o cont√≠nua ‚Ä¢ Escala 0‚Äì100</small>
    </div>

    <div class="top-actions">
      <div class="chip" onclick="openModal('oquee')">üåø O que √©</div>
      <div class="chip" onclick="openModal('comofunciona')">‚öôÔ∏è Como funciona</div>
      <div class="chip" onclick="openModal('painel')">üìä Painel</div>
      <div class="chip" onclick="voltar()">‚Üê Voltar</div>
      <div class="chip primary" onclick="atualizarTudo()">‚ü≥ Atualizar</div>
    </div>
  </div>

  <div class="main">
    <div class="panel">
      <h3>üß© Camadas P√∫blicas <span id="statusOnline">online</span></h3>

      <div class="kpi">
        <div><b>Base:</b> Sat√©lite (NASA GIBS / VIIRS)</div>
        <div><b>Dist√∫rbio real:</b> Inc√™ndios (NASA EONET)</div>
      </div>

      <div class="divider"></div>

      <div class="kpi">
        <div><b>Regra:</b></div>
        <div><span class="dot g"></span>üü¢ sem dist√∫rbio</div>
        <div><span class="dot y"></span>üü° alerta</div>
        <div><span class="dot r"></span>üî¥ dist√∫rbio</div>
      </div>

      <div class="divider"></div>

      <div class="kpi">
        <div><b>Atualiza√ß√£o:</b> <span id="txtAtualizacao">‚Äî</span></div>
        <div><b>Eventos (Amaz√¥nia):</b> <span id="txtEventos">‚Äî</span></div>
        <div><b>Pixels desenhados:</b> <span id="txtPontos">‚Äî</span></div>
      </div>

      <div class="divider"></div>

      <div class="kpi">
        <div style="width:100%">
          <b>√çndice Ecol√≥gico Amaz√¥nico (0‚Äì100)</b> <span class="muted">(MVP)</span>
          <div style="margin-top:8px; height:10px; border-radius:99px; background: rgba(255,255,255,.08); overflow:hidden;">
            <div id="barIndex" style="height:10px; width:0%; background: linear-gradient(90deg, rgba(255,84,84,.95), rgba(255,214,102,.95), rgba(26,255,140,.95));"></div>
          </div>
          <div class="muted" style="margin-top:6px; font-size:12px;">
            Valor: <b id="txtIndex">‚Äî</b>
          </div>

          <div class="sliderRow">
            <b>Densidade (pixel):</b>
            <input id="rngStep" type="range" min="2" max="10" value="4"/>
            <span class="muted">step: <b id="lblStep">4</b> px</span>
          </div>
          <div class="muted" style="font-size:11px; margin-top:6px;">
            Menor step = mais ‚Äúpixel real‚Äù (mais pesado). Recomendo 4‚Äì6.
          </div>
        </div>
      </div>
    </div>

    <div class="mapWrap panel" style="padding:0;">
      <div id="map"></div>

      <div class="mapHUD">
        <div class="big">‚óè Sistema ativo ‚Äî Amaz√¥nia</div>
        <div class="small">
          Pixels hologr√°ficos dentro do bioma (geojson) + dist√∫rbio real (EONET) definindo üü¢üü°üî¥.
        </div>
      </div>

      <div class="legend">
        <div style="font-weight:900;">Escala Ecol√≥gica (0‚Äì100)</div>
        <div class="bar"></div>
        <div class="labels">
          <span>Impacto</span>
          <span>Alerta</span>
          <span>Baixo dist√∫rbio</span>
        </div>
      </div>
    </div>

    <div class="panel">
      <h3>üì° Leituras em tempo real <span><span id="txtPontosRight">‚Äî</span> pixels</span></h3>
      <div class="muted" style="font-size:12px; line-height:1.5;">
        Clique em qualquer pixel para ver classifica√ß√£o e dist√¢ncia do dist√∫rbio real.
      </div>

      <div class="divider"></div>

      <div style="font-size:12px; line-height:1.6;">
        <b>√öltimo pixel selecionado</b><br/>
        <div class="muted" id="txtUltimo">‚Äî</div>
      </div>
    </div>

    <div class="bottom">
      <div class="panel">
        <h3>üìà S√©rie temporal (MVP) <span>placeholder</span></h3>
        <div class="muted" style="font-size:12px; line-height:1.6;">
          Pr√≥ximo passo: gr√°fico real do √≠ndice por dia/semana (NDVI + fogo + anomalias + clima).
        </div>
      </div>

      <div class="panel">
        <h3>üß¨ Integridade / Cobertura <span>placeholder</span></h3>
        <div class="muted" style="font-size:12px; line-height:1.6;">
          Pr√≥ximo passo: m√©tricas reais por sat√©lite (NDVI/biomassa) e mudan√ßas de cobertura.
        </div>
      </div>

      <div class="panel">
        <h3>üîí Transpar√™ncia <span>jur√≠dico</span></h3>
        <div class="muted" style="font-size:12px; line-height:1.6;">
          Observat√≥rio Amaz√¥nia ‚Äî Transpar√™ncia ambiental baseada em dados p√∫blicos.<br/>
          Este projeto n√£o constitui oferta de investimento. Plataforma de monitoramento ambiental.
        </div>
      </div>
    </div>
  </div>

  <div class="modalOverlay" id="modalOverlay" onclick="overlayClick(event)">
    <div class="modal">
      <div class="close" onclick="closeModal()">Fechar ‚úï</div>
      <div class="modalTitle" id="modalTitle"></div>
      <div id="modalBody"></div>
    </div>
  </div>

<script>
  // ===== MODAIS =====
  const content = {
    oquee: {
      title: "üåø O que √© o Observat√≥rio Bioecol√≥gico da Amaz√¥nia",
      body: `
        <p>Um painel p√∫blico que transforma <b>dados ambientais reais</b> em leitura visual do estado ecol√≥gico da floresta.</p>
        <p class="muted">Sem pre√ßo, sem promessa, sem venda: apenas monitoramento verific√°vel.</p>
      `
    },
    comofunciona: {
      title: "‚öôÔ∏è Como funciona (MVP)",
      body: `
        <ul class="bullet">
          <li><b>Mapa sat√©lite real</b> (NASA GIBS / VIIRS).</li>
          <li><b>Recorte real do bioma</b> (amazonia.geojson).</li>
          <li><b>Dist√∫rbio real</b> via NASA EONET (inc√™ndios).</li>
          <li><b>Pixeliza√ß√£o</b>: cada ‚Äúpixel‚Äù √© desenhado em canvas e classificado por dist√¢ncia do dist√∫rbio.</li>
        </ul>
        <p class="muted"><b>Regra:</b> dist√∫rbio = üî¥ ‚Ä¢ alerta = üü° ‚Ä¢ sem dist√∫rbio = üü¢.</p>
      `
    },
    painel: {
      title: "üìä Painel Amaz√¥nia ‚Äî voc√™ encontra",
      body: `
        <ul class="bullet">
          <li><b>Sistema ativo da Amaz√¥nia</b></li>
          <li><b>Dados p√∫blicos</b></li>
          <li><b>Atualiza√ß√£o cont√≠nua</b></li>
        </ul>
        <p class="muted">Pixels hologr√°ficos dentro do bioma com classifica√ß√£o üü¢üü°üî¥ por dist√∫rbio real.</p>
      `
    }
  };

  function openModal(key){
    const overlay = document.getElementById("modalOverlay");
    const titleEl = document.getElementById("modalTitle");
    const bodyEl = document.getElementById("modalBody");
    const item = content[key];
    if(!item) return;
    titleEl.innerHTML = item.title;
    bodyEl.innerHTML = item.body;
    overlay.style.display = "flex";
  }
  function closeModal(){ document.getElementById("modalOverlay").style.display = "none"; }
  function overlayClick(e){ if(e.target.id === "modalOverlay") closeModal(); }
  document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeModal(); });

  function voltar(){ window.location.href = "index.html"; }

  // ===== MAPA =====
  const map = L.map("map", { zoomControl:true, preferCanvas:true });

  const gibs = L.tileLayer(
    "https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/VIIRS_SNPP_CorrectedReflectance_TrueColor/default/{time}/GoogleMapsCompatible_Level9/{z}/{y}/{x}.jpg",
    { time: "2026-02-06", tileSize:256, maxZoom:9, attribution:"Leaflet | NASA GIBS (VIIRS)" }
  ).addTo(map);

  const layerBorder = L.geoJSON(null, { interactive:false }).addTo(map);
  const layerMask   = L.geoJSON(null, { interactive:false }).addTo(map);

  // ===== Classifica√ß√£o =====
  const DIST_RED_KM = 80;
  const DIST_YELLOW_KM = 220;

  let amazoniaFeature = null;
  let events = [];

  function setOnline(t){ document.getElementById("statusOnline").textContent = t; }
  function fmtNow(){ return new Date().toLocaleString("pt-BR"); }

  function haversineKm(lat1, lon1, lat2, lon2){
    const R=6371, toRad=v=>v*Math.PI/180;
    const dLat=toRad(lat2-lat1), dLon=toRad(lon2-lon1);
    const a=Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
    return 2*R*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
  }

  function classificar(minKm){
    if(minKm <= DIST_RED_KM) return { cls:"disturbio", cor:"rgba(255,84,84,.95)", label:"üî¥ dist√∫rbio" };
    if(minKm <= DIST_YELLOW_KM) return { cls:"alerta", cor:"rgba(255,214,102,.95)", label:"üü° alerta" };
    return { cls:"ok", cor:"rgba(26,255,140,.95)", label:"üü¢ sem dist√∫rbio" };
  }

  function nearestEvent(lat, lon){
    if(events.length===0) return { minKm: Infinity, best:null };
    let min=Infinity, best=null;
    for(const e of events){
      const km = haversineKm(lat, lon, e.lat, e.lon);
      if(km < min){ min=km; best=e; }
    }
    return { minKm:min, best };
  }

  // ===== Canvas Pixel Layer (o ‚Äúcada pixel = ponto‚Äù) =====
  const PixelLayer = L.Layer.extend({
    initialize: function(){
      this._canvas = L.DomUtil.create('canvas', 'leaflet-pixel-layer');
      this._canvas.style.position = 'absolute';
      this._canvas.style.pointerEvents = 'auto';
      this._ctx = this._canvas.getContext('2d');
      this._stepPx = 4;
      this._lastHit = null;
    },

    setStep: function(px){
      this._stepPx = Math.max(2, Math.min(10, px|0));
      this.redraw();
    },

    onAdd: function(map){
      this._map = map;
      const pane = map.getPanes().overlayPane;
      pane.appendChild(this._canvas);

      map.on('move zoom resize', this._reset, this);
      map.on('moveend zoomend', this.redraw, this);

      L.DomEvent.on(this._canvas, 'click', this._onClick, this);

      this._reset();
      this.redraw();
    },

    onRemove: function(map){
      L.DomUtil.remove(this._canvas);
      map.off('move zoom resize', this._reset, this);
      map.off('moveend zoomend', this.redraw, this);
      L.DomEvent.off(this._canvas, 'click', this._onClick, this);
    },

    _reset: function(){
      const size = this._map.getSize();
      this._canvas.width = size.x;
      this._canvas.height = size.y;

      const topLeft = this._map.containerPointToLayerPoint([0,0]);
      L.DomUtil.setPosition(this._canvas, topLeft);
    },

    redraw: function(){
      if(!amazoniaFeature){ return; }

      const ctx = this._ctx;
      const size = this._map.getSize();
      ctx.clearRect(0,0,size.x,size.y);

      // est√©tica hologr√°fica
      ctx.globalCompositeOperation = "lighter";

      const step = this._stepPx;
      const bounds = this._map.getBounds();
      const bbox = [bounds.getWest(), bounds.getSouth(), bounds.getEast(), bounds.getNorth()];

      // para performance: percorre pixels da tela (n√£o lat/lon em grid fixo)
      // converte cada ponto da tela -> latlng -> testa dentro do geojson -> classifica por dist√∫rbio
      let total=0, g=0,y=0,r=0;

      for(let py=0; py<size.y; py+=step){
        for(let px=0; px<size.x; px+=step){
          const ll = this._map.containerPointToLatLng([px, py]);

          // r√°pido: se estiver fora da bbox atual, ignora (j√° est√°)
          // teste real: ponto dentro do pol√≠gono Amaz√¥nia
          const pt = turf.point([ll.lng, ll.lat]);
          if(!turf.booleanPointInPolygon(pt, amazoniaFeature)) continue;

          const { minKm, best } = nearestEvent(ll.lat, ll.lng);
          const info = classificar(minKm);

          total++;
          if(info.cls==="ok") g++;
          else if(info.cls==="alerta") y++;
          else r++;

          // halo + core (pixel)
          // halo
          ctx.beginPath();
          ctx.fillStyle = info.cor.replace(".95", ".14");
          ctx.arc(px, py, step*1.8, 0, Math.PI*2);
          ctx.fill();

          // core
          ctx.beginPath();
          ctx.fillStyle = info.cor.replace(".95", ".55");
          ctx.arc(px, py, Math.max(1.2, step*0.55), 0, Math.PI*2);
          ctx.fill();
        }
      }

      // √çndice MVP (verde=1, amarelo=0.5, vermelho=0)
      const idx = total ? Math.round(100 * ((g*1 + y*0.5 + r*0) / total)) : 0;

      document.getElementById("txtPontos").textContent = total;
      document.getElementById("txtPontosRight").textContent = total;
      document.getElementById("txtEventos").textContent = events.length;
      document.getElementById("txtAtualizacao").textContent = fmtNow();
      document.getElementById("txtIndex").textContent = idx;
      document.getElementById("barIndex").style.width = Math.max(0, Math.min(100, idx)) + "%";
    },

    _onClick: function(ev){
      if(!amazoniaFeature) return;

      const rect = this._canvas.getBoundingClientRect();
      const x = ev.clientX - rect.left;
      const y = ev.clientY - rect.top;

      const ll = this._map.containerPointToLatLng([x, y]);
      const pt = turf.point([ll.lng, ll.lat]);
      if(!turf.booleanPointInPolygon(pt, amazoniaFeature)) return;

      const { minKm, best } = nearestEvent(ll.lat, ll.lng);
      const info = classificar(minKm);

      const distText = (minKm===Infinity) ? "‚Äî" : (minKm.toFixed(1) + " km");
      const eventoText = best ? `${best.title} (${best.source})` : "‚Äî";

      document.getElementById("txtUltimo").innerHTML = `
        Classifica√ß√£o: <b>${info.label}</b><br/>
        Dist√¢ncia do dist√∫rbio mais pr√≥ximo: <b>${distText}</b><br/>
        Evento mais pr√≥ximo: <b>${eventoText}</b><br/>
        Lat: ${ll.lat.toFixed(3)} | Lon: ${ll.lng.toFixed(3)}
      `;
    }
  });

  const pixelLayer = new PixelLayer();
  pixelLayer.addTo(map);

  // slider densidade
  const rng = document.getElementById("rngStep");
  const lbl = document.getElementById("lblStep");
  rng.addEventListener("input", ()=>{
    lbl.textContent = rng.value;
    pixelLayer.setStep(parseInt(rng.value,10));
  });

  // ===== Carregar GeoJSON Amaz√¥nia =====
  async function carregarAmazonia(){
    const res = await fetch("amazonia.geojson", { cache: "no-store" });
    if(!res.ok) throw new Error("N√£o achei amazonia.geojson (erro " + res.status + ")");
    const gj = await res.json();

    amazoniaFeature = (gj.features && gj.features[0]) ? gj.features[0] : null;
    if(!amazoniaFeature) throw new Error("amazonia.geojson sem feature v√°lida.");

    const b = L.geoJSON(gj).getBounds();
    map.fitBounds(b.pad(0.12));

    layerBorder.clearLayers();
    layerBorder.addData(gj);
    layerBorder.setStyle({ color:"rgba(26,255,140,.55)", weight:2, fillOpacity:0 });

    // m√°scara fora do bioma (buraco da Amaz√¥nia)
    const world = turf.polygon([[[-180,-85], [180,-85], [180,85], [-180,85], [-180,-85]]]);
    const mask = turf.difference(world, turf.feature(amazoniaFeature.geometry));
    if(mask){
      layerMask.clearLayers();
      layerMask.addData(mask);
      layerMask.setStyle({ color:"rgba(0,0,0,0)", weight:0, fillColor:"rgba(0,0,0,.72)", fillOpacity:1 });
    }
  }

  // ===== Dist√∫rbios reais (EONET - wildfires) =====
  async function carregarEventosEONET(){
    const url = "https://eonet.gsfc.nasa.gov/api/v3/events?status=open&category=wildfires&days=30";
    const res = await fetch(url, { cache: "no-store" });
    if(!res.ok) throw new Error("Falha ao buscar EONET (erro " + res.status + ")");
    const json = await res.json();

    events = [];
    const evs = json.events || [];

    for(const ev of evs){
      const g = ev.geometry && ev.geometry.length ? ev.geometry[ev.geometry.length - 1] : null;
      if(!g || !g.coordinates || g.coordinates.length < 2) continue;

      const lon = g.coordinates[0];
      const lat = g.coordinates[1];

      // filtra dentro do bioma
      const pt = turf.point([lon, lat]);
      if(amazoniaFeature && !turf.booleanPointInPolygon(pt, amazoniaFeature)) continue;

      events.push({
        lat, lon,
        title: ev.title || "Wildfire (EONET)",
        date: g.date || "",
        source: "NASA EONET"
      });
    }
  }

  async function atualizarTudo(){
    try{
      setOnline("online");
      await carregarAmazonia();
      await carregarEventosEONET();
      pixelLayer.redraw();
    }catch(err){
      setOnline("erro");
      alert("Erro ao atualizar: " + err.message + "\n\nConfira:\n- amazonia.geojson existe na raiz?\n- nome do arquivo est√° igual?\n- GitHub Pages atualizou?");
    }
  }

  // start
  atualizarTudo();
  setInterval(atualizarTudo, 10 * 60 * 1000);
</script>

</body>
</html>
